---
title: "2020 05 08 部署记录01"
date: 2020-05-08T11:38:06+08:00
draft: false
url: /web/blog/2020/note/2020050802.html
---

### 服务器部署记录


#### 个人项目取消oss 

由于oss的存储和访问都需要计费。最经济的情况下，使用coding pages和 jsdelivr代替之前的oss文件。原oss里文件，整天搬迁到coding pages上，域名和访问地址不变。

后续的静态资源引用使用jsdelivr或者coding pages 的url地址。 考虑到coding pages访问速度不稳定。可以使用国内cdn加速。

由于计费问题，取消所有oss服务。外部访问的文件全部下载下来单独保存。backup文件暂时保留。

#### 对服务器和git仓库全面使用秘钥登录

对coding仓库，github仓库，云服务器全面使用私钥登录。

#### 不再使用php
个人的网站和网页设计不再使用php项目。

#### 页面发布步骤

WWw页面是一个归纳页面,首先访问www页面,建立单独仓库和发布源.

然后通过选择不同的内容,跳转到文章更新和随笔网页. 跟www页面属于不同的发布源.

关于页面均在www页面

#### 精简仓库数量
简化coding上的仓库数量,保留一个备份和一个pages仓库.

#### hugo站点的发布过程
原先对hugo的编辑是直接在主题文件夹里的源代码进行修改,这样主题更新以后,要么源代码被覆盖,要么重新设置.

而现在,将部分文件转移到根目录下的data,assets,layouts等目录里,配置信息同主题分离.以方便以后更换主题或主题更新.

css,font,js文件均有根目录下的文件夹提供(统一归为custom文件).

修改文件直接在git仓库目录下编辑,将git仓库文件同本地临时配置文件夹合为一个,对于测试代码,可以新建分支或仓库,避免主目录太多太乱.

### 进一步整理git仓库


对主文件目录base,同时链接两个远程库a和b,两个远程库分别放置**最近更新**和**稳定更新**的内容.

后续,进一步差异化两个远程库的文件.对应的,pages也分成最近更新和稳定更新的内容.

一个base文件夹同时对应远程库a的base,和远程库b的base


### 取消本地电脑的本地仓库

一般情况下使用vsc在电脑上直接编辑远程服务器上的本地库,然后同步到远程库,尽可能的减少放到本地电脑的版本.

github上的仓库仅仅用作jsdelivr 的cdn源,本地一般不直接向github的仓库推送,只有在服务器端向github推送

gitee和阿里云等其他git代码托管的仓库全部取消.

用于web访问的域名为 页面: hbn.pub  资源:ufs.pub  备用 :ufs.im


### 为什么要频繁整理

随着采用的理论和技术越来越细致,过去的方法越来越不合适.有必要增加新的管理方法,采用新的技术.这就会导致旧的东西跟新东西发生冲突.


体现在网站内容上,由于采用了新的文件管理方法.新的页面将统一采用新的文件结构,新的UFS结构重新命名了主文件夹和次级文件夹,重新规范了命名规则.一直运行的旧的b.hbn.pub仍然使用旧的结构不变.新更新的内容将采用新结构.


对于归档.可以考虑在某个时间对整个b.hbn.pub做归档,启用一个专用的归档域名.


### 本地仓库同步到多个远程库

通过以下命令将远程库加入 origin 列表里
`git remote set-url --add origin  **自己的仓库名**`

再通过git remote -v 查看远程版本库信息，显示如下

这样可以,将一个本地文件同步到多个远程仓库里,以起到冗余备份的功能.




### 魔改主题

hugo的主目录下的 主目录/layouts/partials 是可以替代 主题目录/layouts/partials 文件的.

由于hugo-meme主题不支持某些bootstrap4代码,魔改主题需要修改对应的html代码,

在这个主目录/layouts/partials里的修改不影响后续主题更新

/layouts/partials里并没有css文件,对css文件的修改可以采取新建css文件覆盖配置的方式.

### 采用框架是有必要的

由于页面的复杂性,对html建立一个基础的布局,样式模板是有必要的,模块式开发和设计.Bootstrap 是全球最受欢迎的前端组件库,应该引用和支持.


### 由于一次故障引起的全面调整

由于coding pages的一次故障,所有coding pages服务被标记为"不可靠",跟github pages一样归位"备用"资源.所有部署在coding上的资源转移到云服务器上.

### hugo docsy主题不适用

尽管hugo docsy主题功能强大,但本人对于此主题的页面设计还没完全配置好,导致页面不够美观.暂时不将此主题部署到博客项目.

由于hugo docsy主题暂标记为"不适用",合并博客网页和单独网页的想法暂时无法实现.还是需要同时使用hugo meme主题和hugo primer主题两个网页.

### 文章的结构优化

posts内的文章进行优化,分类和标签逐步开始添加.归档内容(上一年以及更正的文章)不再修改.大量文章的url地址被修改.(放弃url长期化支持)