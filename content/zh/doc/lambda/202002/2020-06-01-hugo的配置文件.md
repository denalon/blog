---
author: denalon
title: "2020 06 01 Hugo的配置文件"
linkTitle: "2020 06 01 Hugo的配置文件"
date: 2020-06-01T10:43:07+08:00
draft: false
url: /web/deploy/2020/202006011.html
description: > 
                对 Hugo的配置文件的简单介绍
---

### 遇到的问题

由于github pages经常访问慢，甚至无法访问，coding也是隔三差五出访问异常，我需要部署多个pages源站点做到多站点同步。而在gitlab上部署时遇到了问题：

这里以普通情况为主，github和coding可以将整个站点发布到pages上，Netlify同样可以直接使用github站点。唯独gitlab跟其他都不一样需要将站点内容放到public文件夹里，配置文件放根目录。

而问题在于，由于我没有使用持续集成的方式，而采用极其原始的直接将public 推到git上部署页面。使得**网站配置文件同pages文件是不同的git仓库**，而网站配置文件的git仓库是直接将public文件夹屏蔽掉的。所以，一个仓库里有配置文件但没有public，一个仓库里有所有页面但是不在public里。

### 为什么如此？

如果采用持续集成的方式部署页面，就解决了很多问题，而由于自己强迫症的问题，一个页面是发布到多个平台，甚至有aws s3，阿里云oss等等。既要在不同的git仓库上配置持续集成，又希望所有站点内容一模一样，结果就很难实现，因为serverless  cloudflare workers等等需要不同的配置文件和cname。加之某些部署时的技术问题一直没有解决。不得不将public在一个地方生成，然后统一发布出去。

### 对github pages和gitlab pages不同的解决

运行hugo 时，加上参数 -d xxxx   

xxxx 为目录名 就可以代替public目录名

### production生产版本
在hugo根目录下创建config文件夹，将原来的config.toml转到到这个目录下，作为hugo的配置文件目录

创建 `_default` 文件夹，`config.toml`文件

**`config.toml`** 存放hugo的默认配置文件，运行`hugo`时生成`public`文件夹（可以通过`publishDir = "目录名"`修改）

创建 `production` 文件夹，`config.toml`文件，增加`publishDir = "目录名"` 在运行`hugo`时生成`public`文件夹和另一个目录,

这个production就是hugo使用配置文件新建的生产版内容，可以通过配置`production` 文件夹的`config.toml`文件，设置某些正式发布的内容。

这个`publishDir = "目录名"` 的目录名可以是hugo根目录下的子目录**目录/子目录**

### staging 试验版本

通过在config文件夹下，新建`staging`文件夹

通过运行`hugo --environment staging`生成临时测试版本。

